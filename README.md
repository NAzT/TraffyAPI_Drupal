เกริ่น
--------------
ดองมาจะครบเดือนอยู่แล้ว ต้องอัพเดตเสียหน่อย
blog ตอนที่แล้ว (ดูภาพจากกล้อง CCTV ทั่วกรุงเทพ ด้วย TraffyAPI (และ Drupal7))  ได้ทำ drupal7 module เพื่อทดสอบ Traffy API
ก็ได้พบกับปัญหาจุกจิกเล็กๆน้อย ปัญหาหลักๆที่กวนใจก็คือเรื่อง http referer เนี่ยแหละ
แต่จริงๆผมอาจจะติดกับพวก Public  Facebook API หรือ Twitter API มากเกินไปที่ไม่ต้องใช้ http referrer

ปัญหาที่พบ
--------------

หลังจากที่ลองเล่น  Traffy API มานิดนึง เพื่อหวังหาไอเดียทำอะไรซักอย่าง ก็เจอกับปัญหา referrer เข้าอย่างจัง

มีวันนึงผมจะเขียน google chrome extension แต่ว่าเจอปัญหา Request ไปขอข้อมูลอะไรไม่ได้เลย เพราะมึนเรื่อง http referrer

สิ่งที่ทำ
--------------

ผมเลยทำ Traffy API Wrapper ซะเลย แต่ไม่รู้ว่าจะเรียกว่า Wrapper หรือ  Proxy ดี แต่ชอบคำว่า Wrapper  มากกว่า มันดูเท่ดี (ว่าไปนั่น)

หน้าที่ของสิ่งที่ทำ
--------------
หน้าที่ของ module Traffy API Wrapper มีหน้าที่แค่ รับ request จากทางบ้าน แล้ว request ต่อไปที่ Server Traffy API

อ้าว!! แล้วมันแตกต่างกับการเรียกใช้ Traffy API ของ Nectec ยังไงล่ะ?

ความแตกต่างระหว่าง Traffy API กับ Traffy API Wrapper
--------------
1. สามารถใช้ได้เลย ไม่ต้องใช้ apikey และ appid (เฉพาะ api ที่ผมคิดว่า ไม่จำเป็นต้อง authenticate)
2. (อาจจะ) ไม่ต้องปวดหัวกับ ปัญหา referrer
3. map api ให้ตรงกับเอกสาร (เช่น 'getTrafficCongestion' =&gt; 'getCL', 'getCCTVimg' =&gt; 'getcctvimg') แก้ไขปัญหาเอกสารไม่ตรงกับ api
4. ปรับให้ใช้เรียก api โดยไม่สนใจอักขระตัวเล็กตัวใหญ่ (case insensitive)

สำหรับแนวทางการพัฒนาต่อไป
--------------
- ผมมีแผนที่จะแคชข้อมูลบางตัวให้ เพื่อแก้ไขปัญหาความช้าของ Server ที่ส่งผลลัพธ์
- ลืมแล้วว่าคิดอะไรไว้ !!

วิธีการใช้งาน
--------------
1. เลือก api ที่ต้องการใช้งานจาก http://info.traffy.in.th/api/ แต่แนะนำให้ดู API จากเมนูด้านบน ข้างๆเมนู "หน้าแรก"
[เพราะว่า การติดต่อกับ traffy api จะต้องใช้ apikeyy appid และ จะต้องเรียกจากเว็บไซต์ที่เราใส่ url ไว้แล้วเท่านั้น (แก้ไขurl ไม่ได้ ต้อง add ใหม่)

